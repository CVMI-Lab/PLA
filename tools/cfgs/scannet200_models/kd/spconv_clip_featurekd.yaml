_BASE_CONFIG_: cfgs/scannet200_models/spconv_clip.yaml

DATA_CONFIG:
  _BASE_CONFIG_: cfgs/dataset_configs/scannet200_dataset.yaml
  ignore_class_idx: [ 0, 2, 35, 98, 136, 147, 153, 159, 166, 167, 183, 186, 191, 198 ]
  LOAD_KD_LABEL_TRAIN: True
  KD_LABEL_DIR: ../data/scannetv2/lseg_feats_125k_norm
  KD_LABEL_NORM: True

MODEL:
  NAME: SparseUNetTextSeg
  REMAP_FROM_3DLANG: False
  REMAP_FROM_KDADAPTER: False

  VFE:
    NAME: IndoorVFE
    USE_XYZ: True

  BACKBONE_3D:
    NAME: SparseUNetIndoor
    IN_CHANNEL: 6
    MID_CHANNEL: 16
    BLOCK_RESIDUAL: True
    BLOCK_REPS: 2
    NUM_BLOCKS: 7
    CUSTOM_SP1X1: True

  ADAPTER:
    NAME: VLAdapter
    EVAL_ONLY: False
    NUM_ADAPTER_LAYERS: 2  # 2 layers
    TEXT_DIM: -1
    LAST_NORM: False  # no BN and ReLU

  KD_HEAD:
    NAME: KDHeadTemplate
    IN_FEAT_NAME: adapter_feats
    FEAT_NORM: True
    
    LOSS_CONFIG:
      LOSS_WEIGHT: 1.0

  TASK_HEAD:
    NAME: TextSegHead
    FEAT_NORM: True
    EVAL_ONLY: True
    IN_FEAT_NAME: adapter_feats
    IN_CHANNEL: 512
    # NO_V2P_MAP: True

    TEXT_EMBED:
      NAME: CLIP
      NORM: True
      PATH: text_embed/scannet200_clip-ViT-B32_id.pth
    LOGIT_SCALE:
      value: 1.0
      learnable: False

TEXT_ENCODER:
  NAME: CLIP
  BACKBONE: ViT-B/32  # ['RN50', 'RN101', 'RN50x4', 'RN50x16', 'RN50x64', 'ViT-B/32', 'ViT-B/16', 'ViT-L/14']
  TEMPLATE: lseg
  EXTRACT_EMBED: True  # Online extract text embeding from class or not
  CATEGORY_NAMES: ['wall', 'chair', 'floor', 'table', 'door', 'couch', 'cabinet', 'shelf', 'desk', 'office chair',
                  'bed', 'pillow', 'sink', 'picture', 'window', 'toilet', 'bookshelf', 'monitor', 'curtain', 'book',
                  'armchair', 'coffee table', 'box', 'refrigerator', 'lamp', 'kitchen cabinet', 'towel', 'clothes', 'tv', 'nightstand',
                  'counter', 'dresser', 'stool', 'cushion', 'plant', 'ceiling', 'bathtub', 'end table', 'dining table', 'keyboard',
                  'bag', 'backpack', 'toilet paper', 'printer', 'tv stand', 'whiteboard', 'blanket', 'shower curtain', 'trash can', 'closet',
                  'stairs', 'microwave', 'stove', 'shoe', 'computer tower', 'bottle', 'bin', 'ottoman', 'bench', 'board',
                  'washing machine', 'mirror', 'copier', 'basket', 'sofa chair', 'file cabinet', 'fan', 'laptop', 'shower', 'paper',
                  'person', 'paper towel dispenser', 'oven', 'blinds', 'rack', 'plate', 'blackboard', 'piano', 'suitcase', 'rail',
                  'radiator', 'recycling bin', 'container', 'wardrobe', 'soap dispenser', 'telephone', 'bucket', 'clock', 'stand', 'light',
                  'laundry basket', 'pipe', 'clothes dryer', 'guitar', 'toilet paper holder', 'seat', 'speaker', 'column', 'bicycle', 'ladder',
                  'bathroom stall', 'shower wall', 'cup', 'jacket', 'storage bin', 'coffee maker', 'dishwasher', 'paper towel roll', 'machine', 'mat',
                  'windowsill', 'bar', 'toaster', 'bulletin board', 'ironing board', 'fireplace', 'soap dish', 'kitchen counter', 'doorframe', 'toilet paper dispenser',
                  'mini fridge', 'fire extinguisher', 'ball', 'hat', 'shower curtain rod', 'water cooler', 'paper cutter', 'tray', 'shower door', 'pillar',
                  'ledge', 'toaster oven', 'mouse', 'toilet seat cover dispenser', 'furniture', 'cart', 'storage container', 'scale', 'tissue box', 'light switch',
                  'crate', 'power outlet', 'decoration', 'sign', 'projector', 'closet door', 'vacuum cleaner', 'candle', 'plunger', 'stuffed animal',
                  'headphones', 'dish rack', 'broom', 'guitar case', 'range hood', 'dustpan', 'hair dryer', 'water bottle', 'handicap bar', 'purse',
                  'vent', 'shower floor', 'water pitcher', 'mailbox', 'bowl', 'paper bag', 'alarm clock', 'music stand', 'projector screen', 'divider',
                  'laundry detergent', 'bathroom counter', 'object', 'bathroom vanity', 'closet wall', 'laundry hamper', 'bathroom stall door', 'ceiling light', 'trash bin', 'dumbbell',
                  'stair rail', 'tube', 'bathroom cabinet', 'cd case', 'closet rod', 'coffee kettle', 'structure', 'shower head', 'keyboard piano', 'case of water bottles',
                  'coat rack', 'storage organizer', 'folded chair', 'fire alarm', 'power strip', 'calendar', 'poster', 'potted plant', 'luggage', 'mattress']
#  BERT:
#  BACKBONE: bert-base-uncased

OPTIMIZATION:
  BATCH_SIZE_PER_GPU: 4
  NUM_EPOCHS: 96
  LR: 0.004  # 4e-3
  SCHEDULER: adam_onecycle
  OPTIMIZER: adam_onecycle
  WEIGHT_DECAY: 0.0001
  MOMENTUM: 0.9
  MULTIPLIER: 0.1
  CLIP_GRAD: False
  PCT_START: 0.4
  DIV_FACTOR: 2
  MOMS: [0.95, 0.85]

OTHERS:
  PRINT_FREQ: 20
  SYNC_BN: False
  USE_AMP: True
